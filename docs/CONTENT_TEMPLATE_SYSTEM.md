# Content Template System

## Overview

The Content Template System replaced the previous static content types (formerly "Article", "Owned PDP", "Retailer PDP") with a flexible template designer that allows users to create custom content structures with configurable input and output fields.

## Navigation

Templates are accessible through the sidebar navigation under the "Content" section. The navigation displays:

- All Templates (list page)
- System Default Templates:
  - Article Template
  - Product Template
- User-Created Templates (up to 5 most recent)

## Core Functionality

### Default Templates

The system includes two pre-configured templates:

1. **Article Template**
   - Input fields: Title, Topic, Keywords
   - Output fields: Article Body, Meta Description
   - AI features: Title suggestions, Keyword suggestions, and auto-generated content

2. **Product Template**
   - Input fields: Product Name, Category, Key Features, Target Audience
   - Output fields: Short Description, Long Description, Key Benefits
   - AI features: Target audience suggestions and auto-generated product descriptions

### Template Designer

1. **Template Management**
   - Create, edit, and delete templates
   - Template listing with search and filtering
   - Templates stored as JSON configurations

2. **Field Configuration**
   - Input Fields: Fields that require user input when creating content
   - Output Fields: Fields that will be generated by AI based on input fields
   - Drag-and-drop reordering of fields

### Input Field Types

The system supports various input field types, including:
- Short Text (single line)
- Long Text (multi-line)
- Rich Text (formatted)
- Select/Dropdown (predefined options)
- Number
- Date/Time
- Keywords/Tags
- URL
- File Upload

### Output Field Types

Output fields can be configured as:
- Plain Text
- Rich Text (with formatting)
- HTML (for advanced formatting)

### AI Integration

The system integrates with Azure OpenAI for intelligent content generation:

1. **Input Field AI Suggestions**
   - Customizable AI prompts for field suggestions
   - Context-aware suggestions based on other field values
   - Variable substitution using {{fieldName}} syntax

2. **Output Field AI Auto-Complete**
   - AI-generated content based on input fields
   - Customizable prompts for each output field
   - Field-specific generation parameters

## Implementation

### Database Structure

```sql
CREATE TABLE content_templates (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name TEXT NOT NULL,
  description TEXT,
  icon TEXT,
  fields JSONB NOT NULL,
  created_by UUID REFERENCES profiles(id) ON DELETE SET NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

ALTER TABLE content ADD COLUMN template_id UUID REFERENCES content_templates(id);
ALTER TABLE content ADD COLUMN field_values JSONB;
```

### API Routes

- `/api/content-templates` - List, create templates
- `/api/content-templates/[id]` - Get, update, delete specific template
- `/api/ai/suggest` - Get AI suggestions for input fields
- `/api/ai/generate` - Generate content for output fields

### Frontend Components

- `TemplateForm` - Form for creating and editing templates
- `FieldDesigner` - Modal for configuring template fields
- `TemplateCard` - Card component for displaying templates

## Usage Flow

1. Admin creates custom templates with input and output fields
2. Content creators select a template when creating new content
3. Content creators fill in input fields (with optional AI suggestions)
4. AI generates content for output fields based on input fields
5. Content creators review and edit the generated content
6. Content is saved with reference to the template used

## Security Considerations

- Template creation is restricted to admin users
- Field validation prevents injection attacks
- Rate limiting on AI generation endpoints
- All user input is sanitized before use in AI prompts 