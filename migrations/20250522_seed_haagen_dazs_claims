-- migrations/YYYYMMDDHHMMSS_seed_haagen_dazs_claims.sql
-- Replace YYYYMMDDHHMMSS with the current timestamp, e.g., 20240801120000

BEGIN;

-- 0. Define Enums (Idempotently)
DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'claim_type_enum') THEN
        CREATE TYPE public.claim_type_enum AS ENUM ('allowed', 'disallowed', 'mandatory', 'conditional');
    ELSE
        -- Add 'conditional' if it's missing. This is a bit complex for existing enums.
        -- For simplicity, this script assumes if the type exists, it's sufficient.
        -- If 'conditional' is truly needed and missing, manual ALTER TYPE ADD VALUE might be required
        -- or ensure it's part of the existing enum:
        -- ALTER TYPE public.claim_type_enum ADD VALUE IF NOT EXISTS 'conditional';
        RAISE NOTICE 'claim_type_enum already exists.';
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'claim_level_enum') THEN
        CREATE TYPE public.claim_level_enum AS ENUM ('brand', 'product', 'ingredient');
    ELSE
        RAISE NOTICE 'claim_level_enum already exists.';
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'claim_category_enum') THEN
        CREATE TYPE public.claim_category_enum AS ENUM (
            'Quality', 'Dairy Base', 'Texture', 'Specific Ingredients', 
            'Product Quality', 'Ingredient Simplicity', 'Dietary Restrictions', 
            'Origin of ingredient', 'No/No/No', 'Stabilisers/Additives', 
            'Heritage', 'Craftmanship', 'Best consumed', 'Coating', 'General'
        );
    ELSE
        RAISE NOTICE 'claim_category_enum already exists.';
    END IF;
END $$;

-- 1. Alter Tables (Idempotently)
ALTER TABLE public.claims ADD COLUMN IF NOT EXISTS claim_category public.claim_category_enum NULL;
ALTER TABLE public.products ADD COLUMN IF NOT EXISTS format TEXT NULL;
COMMENT ON COLUMN public.products.format IS 'Stores the product format, e.g., Pint, Minicups, Sticks.';

-- STEP 1: Add the required unique constraint to the products table (using new column name)
ALTER TABLE products
ADD CONSTRAINT IF NOT EXISTS products_name_master_brand_id_key UNIQUE (name, master_brand_id);

-- 2. Seed Data
DO $$
DECLARE
    haagen_dazs_master_brand_id UUID := '0900beb9-1951-4611-b876-4c66c7ee1a40'; // Renamed variable
    haagen_dazs_country_brand_id UUID; -- This refers to the main 'brands' table ID, not master_claim_brands
    product_record RECORD;
BEGIN
    -- Ensure Haagen-Dazs Master Claim Brand Exists
    INSERT INTO public.master_claim_brands (id, name, created_at, updated_at) -- Renamed table
    VALUES (haagen_dazs_master_brand_id, 'Haagen-Dazs', NOW(), NOW())
    ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated_at = NOW();

    RAISE NOTICE 'Ensured Haagen-Dazs exists in master_claim_brands with ID: %', haagen_dazs_master_brand_id;

    -- Ensure Haagen-Dazs Country-Specific Brand Exists and Get ID (from main 'brands' table)
    INSERT INTO public.brands (name, country, language, created_at, updated_at)
    VALUES ('Haagen-Dazs', 'GLOBAL', 'en', NOW(), NOW()) 
    ON CONFLICT (name) DO UPDATE SET 
        country = EXCLUDED.country, 
        language = EXCLUDED.language,
        updated_at = NOW()
    RETURNING id INTO haagen_dazs_country_brand_id;

    IF haagen_dazs_country_brand_id IS NULL THEN
        SELECT id INTO haagen_dazs_country_brand_id FROM public.brands WHERE name = 'Haagen-Dazs' LIMIT 1;
    END IF;

    IF haagen_dazs_country_brand_id IS NULL THEN
        RAISE EXCEPTION 'Could not find or create Haagen-Dazs in public.brands table. Migration cannot proceed.';
    END IF;
    RAISE NOTICE 'Using Haagen-Dazs country-specific brand ID (from main brands table): %', haagen_dazs_country_brand_id;

    -- Seed Brand-Level Claims (First data block)
    RAISE NOTICE 'Seeding brand-level claims...';

    -- Quality
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES -- Renamed column
    (haagen_dazs_master_brand_id, 'brand', 'Quality', 'allowed', 'High quality, premium, work with best farms for dairy', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Quality', 'disallowed', 'Unsubstantiated "best" or comparative quality claims', 'Cannot be used for specific SKU. Mentioned on list', '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Quality', 'allowed', 'Real/Natural: Refer SKU sheet', NULL, '__GLOBAL__', NULL), 
    (haagen_dazs_master_brand_id, 'brand', 'Quality', 'disallowed', '100% natural', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Quality', 'disallowed', 'all-natural', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Quality', 'disallowed', 'blanket "real" across the product', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Quality', 'disallowed', 'Only', NULL, '__GLOBAL__', NULL);

    -- Dairy Base - Cream
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with Fresh Cream', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with Real Cream', 'Not approved for France', '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with Pure Cream', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Dairy Base', 'disallowed', '100% real cream, or implying only cream used', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Dairy Base', 'disallowed', 'French Cream', NULL, '__GLOBAL__', NULL);
    
    -- Dairy Base - Milk
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with milk', 'Regional approval required', '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Dairy Base', 'disallowed', '"Fresh" or "unprocessed" milk (uses condensed skim milk)', NULL, '__GLOBAL__', NULL);

    -- Texture
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Texture', 'allowed', 'Smooth, rich, luxurious', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Texture', 'allowed', 'Creamy', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Texture', 'allowed', 'melts slowly in your mouth', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Texture', 'disallowed', 'Unsubstantiated "best" or comparative quality claims', 'Cannot be used for specific SKU. Mentioned on list', '__GLOBAL__', NULL);

    -- Specific Ingredients - Biscuit/Cookies
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Specific Ingredients', 'allowed', 'Crunchy, Crunch (If describing as an ingredient being added to Ice Cream)', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Specific Ingredients', 'disallowed', 'As a texture within the Ice Cream or when consuming', NULL, '__GLOBAL__', NULL);
    
    -- Product Quality - Overrun/Density
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Product Quality', 'allowed', 'Dense, low-air ice cream (descriptive)', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Product Quality', 'disallowed', 'Comparative overrun claims without approval', NULL, '__GLOBAL__', NULL);

    -- Ingredient Simplicity
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Ingredient Simplicity', 'allowed', 'Starts with five simple ingredients (cream, milk, sugar, eggs and water)', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Ingredient Simplicity', 'disallowed', 'That these are the only ingredients, implying best', NULL, '__GLOBAL__', NULL);

    -- Dietary Restrictions
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Dietary Restrictions', 'allowed', 'Suitable for vegetarians', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Dietary Restrictions', 'allowed', 'Suitable for vegans (for sorbets)', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Dietary Restrictions', 'allowed', 'Halal (except alcohol)', NULL, '__GLOBAL__', NULL);

    -- Origin of ingredient - Milk
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Origin of ingredient', 'allowed', 'Made with Milk from European farms', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Origin of ingredient', 'disallowed', 'Made in France', NULL, '__GLOBAL__', NULL);

    -- No/No/No - Free-from Claims
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'No/No/No', 'allowed', 'No artificial flavours', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'No/No/No', 'allowed', 'No Colours', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'No/No/No', 'allowed', 'No palm oil', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'No/No/No', 'disallowed', 'Broad "no artificial anything" without specifics', NULL, '__GLOBAL__', NULL);

    -- Stabilisers/Additives
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Stabilisers/Additives', 'conditional', 'Check SKU list', NULL, '__GLOBAL__', NULL), 
    (haagen_dazs_master_brand_id, 'brand', 'Stabilisers/Additives', 'disallowed', 'Blanket statements across SKUs without confirmation', NULL, '__GLOBAL__', NULL);

    -- Heritage
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Heritage', 'allowed', 'Over 65 years of experience', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Heritage', 'allowed', 'Driven to be the world\'\'s best Ice cream', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Heritage', 'allowed', 'Established since 1960', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Heritage', 'allowed', 'founded by the Mattus family', NULL, '__GLOBAL__', NULL);

    -- Craftmanship
    INSERT INTO public.claims (master_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_master_brand_id, 'brand', 'Craftmanship', 'allowed', 'Carefully crafted', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Craftmanship', 'allowed', 'Crafted by expert chefs', NULL, '__GLOBAL__', NULL),
    (haagen_dazs_master_brand_id, 'brand', 'Craftmanship', 'allowed', 'driven for perfection', NULL, '__GLOBAL__', NULL);

    RAISE NOTICE 'Finished seeding brand-level claims.';

    RAISE NOTICE 'Seeding products and product-level claims...';
    
    -- Product: Häagen-Dazs Caramel Mini Cups Ice Cream 4x95ml (SKU: 3415581545920)
    -- NOTE: The column 'country_specific_brand_id' in products table seems to be legacy or for a different purpose.
    -- Product claims here link directly to product_id and the claim's master_brand_id for brand context if needed.
    -- For product-level claims, master_brand_id in claims table should be NULL as per chk_claim_level_reference.
    -- The products table still needs its link to master_claim_brands.
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by) -- Renamed global_brand_id to master_brand_id
    VALUES ('Häagen-Dazs Caramel Mini Cups Ice Cream 4x95ml', '3415581545920', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581545920'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Fruit Mini Cups Ice Cream 4x95ml (SKU: 3415581520927)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Fruit Mini Cups Ice Cream 4x95ml', '3415581520927', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581520927'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Vanilla Collection Mini Cups Ice Cream 4 x 95ml (SKU: 3415581586923)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Vanilla Collection Mini Cups Ice Cream 4 x 95ml', '3415581586923', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581586923'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);
        
    -- Product: Häagen-Dazs Favourites Mini Cups Ice Cream 4x95ml (SKU: 3415582501925)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Favourites Mini Cups Ice Cream 4x95ml', '3415582501925', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415582501925'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Indulgence Collection Mini Ice Cream Tubs 4x95ml (SKU: 3415582835129)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Indulgence Collection Mini Ice Cream Tubs 4x95ml', '3415582835129', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415582835129'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Dessert Collection Mini Ice Cream Tubs 4x95ml (SKU: 3415582836126)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Dessert Collection Mini Ice Cream Tubs 4x95ml', '3415582836126', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415582836126'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream Multipack 4 x 95 ML (SKU: 3415581509120)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream Multipack 4 x 95 ML', '3415581509120', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581509120'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream Minicups 2 x 95M (SKU: 3415583405123)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream Minicups 2 x 95M', '3415583405123', 'Minicups', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583405123'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream 460ml (SKU: 3415581114928)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream 460ml', '3415581114928', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581114928'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Strawberry Cheesecake Ice Cream 460ml (SKU: 3415581176025)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Strawberry Cheesecake Ice Cream 460ml', '3415581176025', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581176025'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Vanilla Ice Cream 460 ml (SKU: 3415581101928)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Vanilla Ice Cream 460 ml', '3415581101928', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581101928'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Belgian Chocolate Ice Cream 460ml (SKU: 3415581113921)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Belgian Chocolate Ice Cream 460ml', '3415581113921', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581113921'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Specific Ingredients', 'allowed', 'Real Belgian Chocolate', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Cookies & Cream Ice Cream 386g (SKU: 3415580000000)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Cookies & Cream Ice Cream 386g', '3415580000000', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415580000000'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Strawberries & Cream Ice Cream 460ml (SKU: 3415581105926)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Strawberries & Cream Ice Cream 460ml', '3415581105926', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581105926'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Specific Ingredients', 'allowed', 'Real Strawberry', 'Not for France', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', NULL, '__GLOBAL__', NULL);
        
    -- Product: Häagen-Dazs Pralines & Cream Ice Cream 460ml (SKU: 3415581153026)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Pralines & Cream Ice Cream 460ml', '3415581153026', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581153026'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Caramel, Biscuit & Cream Ice Cream 460ml (SKU: 3415581117929)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Caramel, Biscuit & Cream Ice Cream 460ml', '3415581117929', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581117929'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Dulce De Leche Ice Cream 460ml (SKU: 3415581162929)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Dulce De Leche Ice Cream 460ml', '3415581162929', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581162929'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Mango & Raspberry Ice Cream 460ml (SKU: 3415581165920)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Mango & Raspberry Ice Cream 460ml', '3415581165920', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581165920'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Specific Ingredients', 'allowed', 'Real Fruit', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Coffee Ice Cream 460ml (SKU: 3415581103922)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Coffee Ice Cream 460ml', '3415581103922', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581103922'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Macadamia Nut Brittle Ice Cream 460ml (SKU: 3415581122022)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Macadamia Nut Brittle Ice Cream 460ml', '3415581122022', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581122022'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Blueberries & Cream Ice Cream Tub 460m (SKU: 3415584409922)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Blueberries & Cream Ice Cream Tub 460m', '3415584409922', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415584409922'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Specific Ingredients', 'allowed', 'Real Fruit', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Limited Edition Pistachio & Cream Ice Cream 420ml (SKU: 3415583003923)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Limited Edition Pistachio & Cream Ice Cream 420ml', '3415583003923', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583003923'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream 650 ml (SKU: 3415580502122)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream 650 ml', '3415580502122', 'Pint', haagen_dazs_master_brand_id, NULL) 
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415580502122'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Red Velvet Cheesecake Ice Cream 420ml (SKU: 3415583007921)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Red Velvet Cheesecake Ice Cream 420ml', '3415583007921', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583007921'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Mint Chocolate Ice Cream 420ml (SKU: 3415583008928)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Mint Chocolate Ice Cream 420ml', '3415583008928', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583008928'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Rum & Raisin Ice Cream 420ml (SKU: 3415581104929)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Rum & Raisin Ice Cream 420ml', '3415581104929', 'Pint', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581104929'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Chunky Salted Caramel Ice Cream Sticks 3x80ml (SKU: 3415587547027)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Chunky Salted Caramel Ice Cream Sticks 3x80ml', '3415587547027', 'Sticks', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587547027'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'Milk Chocolate', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'disallowed', 'High quality / premium', 'Because of Emulsifer and Stabiliser Mix', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Crunchy Cookies & Cream Ice Cream Sticks 3x80ml (SKU: 3415587545023)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Crunchy Cookies & Cream Ice Cream Sticks 3x80ml', '3415587545023', 'Sticks', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587545023'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'Milk Chocolate', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'disallowed', 'High quality / premium', 'Because of Emulsifer and Stabiliser Mix', '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Peach & Raspberry Ice Cream Sticks 3x80ml (SKU: 3415587542923)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Peach & Raspberry Ice Cream Sticks 3x80ml', '3415587542923', 'Sticks', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587542923'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'White Chocolate', '__GLOBAL__', NULL), 
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', 'coating naturally coloured via fruit powder used', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', NULL, '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Mango & Passionfruit Ice Cream Sticks 3x80ml (SKU: 3415587543920)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Mango & Passionfruit Ice Cream Sticks 3x80ml', '3415587543920', 'Sticks', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587543920'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'White Chocolate', '__GLOBAL__', NULL), 
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', 'coating naturally coloured via fruit powder used', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'allowed', 'High quality / premium', NULL, '__GLOBAL__', NULL);

    -- Product: Häagen-Dazs Cracking Macadamia Nut Brittle Ice Cream Sticks 3x80ml (SKU: 3415587541025)
    INSERT INTO public.products (name, sku, format, master_brand_id, created_by)
    VALUES ('Häagen-Dazs Cracking Macadamia Nut Brittle Ice Cream Sticks 3x80ml', '3415587541025', 'Sticks', haagen_dazs_master_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, master_brand_id=EXCLUDED.master_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587541025'; END IF;
    INSERT INTO public.claims (product_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'Milk Chocolate', '__GLOBAL__', NULL),
        (product_record.id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, '__GLOBAL__', NULL),
        (product_record.id, 'product', 'Quality', 'disallowed', 'High quality / premium', 'Because of Emulsifer and Stabiliser Mix', '__GLOBAL__', NULL);

    RAISE NOTICE 'Finished seeding products and product-level claims.';

END $$;

COMMIT;

SELECT 'Migration to seed Haagen-Dazs claims completed successfully.';