-- migrations/YYYYMMDDHHMMSS_seed_haagen_dazs_claims.sql
-- Replace YYYYMMDDHHMMSS with the current timestamp, e.g., 20240801120000

BEGIN;

-- 0. Define Enums (Idempotently)
DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'claim_type_enum') THEN
        CREATE TYPE public.claim_type_enum AS ENUM ('allowed', 'disallowed', 'mandatory', 'conditional');
    ELSE
        -- Add 'conditional' if it's missing. This is a bit complex for existing enums.
        -- For simplicity, this script assumes if the type exists, it's sufficient.
        -- If 'conditional' is truly needed and missing, manual ALTER TYPE ADD VALUE might be required
        -- or ensure it's part of the existing enum:
        -- ALTER TYPE public.claim_type_enum ADD VALUE IF NOT EXISTS 'conditional';
        RAISE NOTICE 'claim_type_enum already exists.';
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'claim_level_enum') THEN
        CREATE TYPE public.claim_level_enum AS ENUM ('brand', 'product', 'ingredient');
    ELSE
        RAISE NOTICE 'claim_level_enum already exists.';
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'claim_category_enum') THEN
        CREATE TYPE public.claim_category_enum AS ENUM (
            'Quality', 'Dairy Base', 'Texture', 'Specific Ingredients', 
            'Product Quality', 'Ingredient Simplicity', 'Dietary Restrictions', 
            'Origin of ingredient', 'No/No/No', 'Stabilisers/Additives', 
            'Heritage', 'Craftmanship', 'Best consumed', 'Coating', 'General'
        );
    ELSE
        RAISE NOTICE 'claim_category_enum already exists.';
    END IF;
END $$;

-- 1. Alter Tables (Idempotently)
ALTER TABLE public.claims ADD COLUMN IF NOT EXISTS claim_category public.claim_category_enum NULL;
ALTER TABLE public.products ADD COLUMN IF NOT EXISTS format TEXT NULL;
COMMENT ON COLUMN public.products.format IS 'Stores the product format, e.g., Pint, Minicups, Sticks.';

-- STEP 1: Add the required unique constraint to the products table
ALTER TABLE products
ADD CONSTRAINT products_name_global_brand_id_key UNIQUE (name, global_brand_id);

-- 2. Seed Data
DO $$
DECLARE
    haagen_dazs_global_brand_id UUID := '0900beb9-1951-4611-b876-4c66c7ee1a40';
    haagen_dazs_country_brand_id UUID;
    product_record RECORD;
    -- For created_by, using NULL for this seed script.
    -- If a specific user is needed:
    -- current_user_id UUID := (SELECT id FROM public.profiles WHERE email = 'admin@example.com' LIMIT 1); 
BEGIN
    -- Ensure Haagen-Dazs Global Claim Brand Exists
    INSERT INTO public.global_claim_brands (id, name, created_at, updated_at)
    VALUES (haagen_dazs_global_brand_id, 'Haagen-Dazs', NOW(), NOW())
    ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated_at = NOW();

    RAISE NOTICE 'Ensured Haagen-Dazs exists in global_claim_brands with ID: %', haagen_dazs_global_brand_id;

    -- Ensure Haagen-Dazs Country-Specific Brand Exists and Get ID
    -- This brand_id is needed for product-level claims due to the check constraint.
    INSERT INTO public.brands (name, country, language, created_at, updated_at)
    VALUES ('Haagen-Dazs', 'GLOBAL', 'en', NOW(), NOW()) -- Using 'GLOBAL' as a placeholder country
    ON CONFLICT (name) DO UPDATE SET 
        country = EXCLUDED.country, 
        language = EXCLUDED.language,
        updated_at = NOW()
    RETURNING id INTO haagen_dazs_country_brand_id;

    IF haagen_dazs_country_brand_id IS NULL THEN
        SELECT id INTO haagen_dazs_country_brand_id FROM public.brands WHERE name = 'Haagen-Dazs' LIMIT 1;
    END IF;

    IF haagen_dazs_country_brand_id IS NULL THEN
        RAISE EXCEPTION 'Could not find or create Haagen-Dazs in public.brands table. Migration cannot proceed.';
    END IF;
    RAISE NOTICE 'Using Haagen-Dazs country-specific brand ID: %', haagen_dazs_country_brand_id;

    -- Seed Brand-Level Claims (First data block)
    RAISE NOTICE 'Seeding brand-level claims...';

    -- Quality
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Quality', 'allowed', 'High quality, premium, work with best farms for dairy', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Quality', 'disallowed', 'Unsubstantiated "best" or comparative quality claims', 'Cannot be used for specific SKU. Mentioned on list', 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Quality', 'allowed', 'Real/Natural: Refer SKU sheet', NULL, 'GLOBAL', NULL), -- This is a bit vague, more of a note.
    (haagen_dazs_global_brand_id, 'brand', 'Quality', 'disallowed', '100% natural', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Quality', 'disallowed', 'all-natural', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Quality', 'disallowed', 'blanket "real" across the product', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Quality', 'disallowed', 'Only', NULL, 'GLOBAL', NULL);

    -- Dairy Base - Cream
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with Fresh Cream', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with Real Cream', 'Not approved for France', 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with Pure Cream', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Dairy Base', 'disallowed', '100% real cream, or implying only cream used', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Dairy Base', 'disallowed', 'French Cream', NULL, 'GLOBAL', NULL);
    
    -- Dairy Base - Milk
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Dairy Base', 'allowed', 'Made with milk', 'Regional approval required', 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Dairy Base', 'disallowed', '"Fresh" or "unprocessed" milk (uses condensed skim milk)', NULL, 'GLOBAL', NULL);

    -- Texture
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Texture', 'allowed', 'Smooth, rich, luxurious', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Texture', 'allowed', 'Creamy', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Texture', 'allowed', 'melts slowly in your mouth', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Texture', 'disallowed', 'Unsubstantiated "best" or comparative quality claims', 'Cannot be used for specific SKU. Mentioned on list', 'GLOBAL', NULL);

    -- Specific Ingredients - Biscuit/Cookies
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Specific Ingredients', 'allowed', 'Crunchy, Crunch (If describing as an ingredient being added to Ice Cream)', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Specific Ingredients', 'disallowed', 'As a texture within the Ice Cream or when consuming', NULL, 'GLOBAL', NULL);
    
    -- Product Quality - Overrun/Density
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Product Quality', 'allowed', 'Dense, low-air ice cream (descriptive)', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Product Quality', 'disallowed', 'Comparative overrun claims without approval', NULL, 'GLOBAL', NULL);

    -- Ingredient Simplicity
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Ingredient Simplicity', 'allowed', 'Starts with five simple ingredients (cream, milk, sugar, eggs and water)', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Ingredient Simplicity', 'disallowed', 'That these are the only ingredients, implying best', NULL, 'GLOBAL', NULL);

    -- Dietary Restrictions
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Dietary Restrictions', 'allowed', 'Suitable for vegetarians', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Dietary Restrictions', 'allowed', 'Suitable for vegans (for sorbets)', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Dietary Restrictions', 'allowed', 'Halal (except alcohol)', NULL, 'GLOBAL', NULL);

    -- Origin of ingredient - Milk
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Origin of ingredient', 'allowed', 'Made with Milk from European farms', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Origin of ingredient', 'disallowed', 'Made in France', NULL, 'GLOBAL', NULL);

    -- No/No/No - Free-from Claims
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'No/No/No', 'allowed', 'No artificial flavours', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'No/No/No', 'allowed', 'No Colours', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'No/No/No', 'allowed', 'No palm oil', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'No/No/No', 'disallowed', 'Broad "no artificial anything" without specifics', NULL, 'GLOBAL', NULL);

    -- Stabilisers/Additives
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Stabilisers/Additives', 'conditional', 'Check SKU list', NULL, 'GLOBAL', NULL), -- 'conditional' as it points to a condition
    (haagen_dazs_global_brand_id, 'brand', 'Stabilisers/Additives', 'disallowed', 'Blanket statements across SKUs without confirmation', NULL, 'GLOBAL', NULL);

    -- Heritage
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Heritage', 'allowed', 'Over 65 years of experience', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Heritage', 'allowed', 'Driven to be the world''s best Ice cream', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Heritage', 'allowed', 'Established since 1960', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Heritage', 'allowed', 'founded by the Mattus family', NULL, 'GLOBAL', NULL);

    -- Craftmanship
    INSERT INTO public.claims (global_brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES
    (haagen_dazs_global_brand_id, 'brand', 'Craftmanship', 'allowed', 'Carefully crafted', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Craftmanship', 'allowed', 'Crafted by expert chefs', NULL, 'GLOBAL', NULL),
    (haagen_dazs_global_brand_id, 'brand', 'Craftmanship', 'allowed', 'driven for perfection', NULL, 'GLOBAL', NULL);

    RAISE NOTICE 'Finished seeding brand-level claims.';

    -- Seed Products and Product-Level Claims (Second data block)
    RAISE NOTICE 'Seeding products and product-level claims...';

    -- Product data as an array of objects (easier to iterate in PL/pgSQL or to generate INSERTS)
    -- For simplicity, defining a temporary structure for products to insert
    -- Note: Production column is not used in products table currently.
    --       Real Claims, Chocolate Coating, No Colours, High Quality / Premium become product-level claims.
    
    -- Product: Häagen-Dazs Caramel Mini Cups Ice Cream 4x95ml (SKU: 3415581545920)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Caramel Mini Cups Ice Cream 4x95ml', '3415581545920', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581545920'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Fruit Mini Cups Ice Cream 4x95ml (SKU: 3415581520927)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Fruit Mini Cups Ice Cream 4x95ml', '3415581520927', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581520927'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Vanilla Collection Mini Cups Ice Cream 4 x 95ml (SKU: 3415581586923)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Vanilla Collection Mini Cups Ice Cream 4 x 95ml', '3415581586923', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581586923'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);
        
    -- Product: Häagen-Dazs Favourites Mini Cups Ice Cream 4x95ml (SKU: 3415582501925)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Favourites Mini Cups Ice Cream 4x95ml', '3415582501925', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415582501925'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Indulgence Collection Mini Ice Cream Tubs 4x95ml (SKU: 3415582835129)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Indulgence Collection Mini Ice Cream Tubs 4x95ml', '3415582835129', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415582835129'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Dessert Collection Mini Ice Cream Tubs 4x95ml (SKU: 3415582836126)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Dessert Collection Mini Ice Cream Tubs 4x95ml', '3415582836126', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415582836126'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream Multipack 4 x 95 ML (SKU: 3415581509120)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream Multipack 4 x 95 ML', '3415581509120', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581509120'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream Minicups 2 x 95M (SKU: 3415583405123)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream Minicups 2 x 95M', '3415583405123', 'Minicups', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583405123'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream 460ml (SKU: 3415581114928)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream 460ml', '3415581114928', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581114928'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Strawberry Cheesecake Ice Cream 460ml (SKU: 3415581176025)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Strawberry Cheesecake Ice Cream 460ml', '3415581176025', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581176025'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Vanilla Ice Cream 460 ml (SKU: 3415581101928)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Vanilla Ice Cream 460 ml', '3415581101928', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581101928'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Belgian Chocolate Ice Cream 460ml (SKU: 3415581113921)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Belgian Chocolate Ice Cream 460ml', '3415581113921', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581113921'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Specific Ingredients', 'allowed', 'Real Belgian Chocolate', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Cookies & Cream Ice Cream 386g (SKU: 3415580000000)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Cookies & Cream Ice Cream 386g', '3415580000000', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415580000000'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Strawberries & Cream Ice Cream 460ml (SKU: 3415581105926)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Strawberries & Cream Ice Cream 460ml', '3415581105926', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581105926'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Specific Ingredients', 'allowed', 'Real Strawberry', 'Not for France', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', NULL, 'GLOBAL', NULL);
        
    -- Product: Häagen-Dazs Pralines & Cream Ice Cream 460ml (SKU: 3415581153026)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Pralines & Cream Ice Cream 460ml', '3415581153026', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581153026'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Caramel, Biscuit & Cream Ice Cream 460ml (SKU: 3415581117929)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Caramel, Biscuit & Cream Ice Cream 460ml', '3415581117929', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581117929'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Dulce De Leche Ice Cream 460ml (SKU: 3415581162929)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Dulce De Leche Ice Cream 460ml', '3415581162929', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581162929'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Mango & Raspberry Ice Cream 460ml (SKU: 3415581165920)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Mango & Raspberry Ice Cream 460ml', '3415581165920', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581165920'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Specific Ingredients', 'allowed', 'Real Fruit', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Coffee Ice Cream 460ml (SKU: 3415581103922)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Coffee Ice Cream 460ml', '3415581103922', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581103922'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Macadamia Nut Brittle Ice Cream 460ml (SKU: 3415581122022)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Macadamia Nut Brittle Ice Cream 460ml', '3415581122022', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581122022'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Blueberries & Cream Ice Cream Tub 460m (SKU: 3415584409922)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Blueberries & Cream Ice Cream Tub 460m', '3415584409922', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415584409922'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Specific Ingredients', 'allowed', 'Real Fruit', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Limited Edition Pistachio & Cream Ice Cream 420ml (SKU: 3415583003923)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Limited Edition Pistachio & Cream Ice Cream 420ml', '3415583003923', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583003923'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Salted Caramel Ice Cream 650 ml (SKU: 3415580502122)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Salted Caramel Ice Cream 650 ml', '3415580502122', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL) -- Assuming 650ml is still 'Pint' category for format
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415580502122'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Red Velvet Cheesecake Ice Cream 420ml (SKU: 3415583007921)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Red Velvet Cheesecake Ice Cream 420ml', '3415583007921', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583007921'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Mint Chocolate Ice Cream 420ml (SKU: 3415583008928)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Mint Chocolate Ice Cream 420ml', '3415583008928', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415583008928'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Rum & Raisin Ice Cream 420ml (SKU: 3415581104929)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Rum & Raisin Ice Cream 420ml', '3415581104929', 'Pint', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415581104929'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 10-15 Minutes for best results', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Chunky Salted Caramel Ice Cream Sticks 3x80ml (SKU: 3415587547027)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Chunky Salted Caramel Ice Cream Sticks 3x80ml', '3415587547027', 'Sticks', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587547027'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'Milk Chocolate', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'disallowed', 'High quality / premium', 'Because of Emulsifer and Stabiliser Mix', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Crunchy Cookies & Cream Ice Cream Sticks 3x80ml (SKU: 3415587545023)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Crunchy Cookies & Cream Ice Cream Sticks 3x80ml', '3415587545023', 'Sticks', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587545023'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'Milk Chocolate', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'disallowed', 'High quality / premium', 'Because of Emulsifer and Stabiliser Mix', 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Peach & Raspberry Ice Cream Sticks 3x80ml (SKU: 3415587542923)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Peach & Raspberry Ice Cream Sticks 3x80ml', '3415587542923', 'Sticks', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587542923'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'White Chocolate', 'GLOBAL', NULL), -- Assumed Belgian from pattern, though text says white
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'coating naturally coloured via fruit powder used', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', NULL, 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Mango & Passionfruit Ice Cream Sticks 3x80ml (SKU: 3415587543920)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Mango & Passionfruit Ice Cream Sticks 3x80ml', '3415587543920', 'Sticks', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587543920'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'White Chocolate', 'GLOBAL', NULL), -- Assumed Belgian
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', 'coating naturally coloured via fruit powder used', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'allowed', 'High quality / premium', NULL, 'GLOBAL', NULL);

    -- Product: Häagen-Dazs Cracking Macadamia Nut Brittle Ice Cream Sticks 3x80ml (SKU: 3415587541025)
    INSERT INTO public.products (name, sku, format, global_brand_id, country_specific_brand_id, created_by)
    VALUES ('Häagen-Dazs Cracking Macadamia Nut Brittle Ice Cream Sticks 3x80ml', '3415587541025', 'Sticks', haagen_dazs_global_brand_id, haagen_dazs_country_brand_id, NULL)
    ON CONFLICT (sku) DO UPDATE SET name=EXCLUDED.name, format=EXCLUDED.format, global_brand_id=EXCLUDED.global_brand_id, country_specific_brand_id=EXCLUDED.country_specific_brand_id, updated_at=NOW() RETURNING id INTO product_record.id;
    IF product_record.id IS NULL THEN SELECT id INTO product_record.id FROM products WHERE sku = '3415587541025'; END IF;
    INSERT INTO public.claims (product_id, brand_id, level, claim_category, claim_type, claim_text, description, country_code, created_by) VALUES 
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Best consumed', 'allowed', 'Leave out of freezer for 5-10 Minutes for best results', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Coating', 'allowed', 'Coated with Belgian Chocolate (Sticks)', 'Milk Chocolate', 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'No/No/No', 'allowed', 'No Colours', NULL, 'GLOBAL', NULL),
        (product_record.id, haagen_dazs_country_brand_id, 'product', 'Quality', 'disallowed', 'High quality / premium', 'Because of Emulsifer and Stabiliser Mix', 'GLOBAL', NULL);

    RAISE NOTICE 'Finished seeding products and product-level claims.';

END $$;

COMMIT;

SELECT 'Migration to seed Haagen-Dazs claims completed successfully.';